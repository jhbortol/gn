"use strict";(self.webpackChunkguia_noivas=self.webpackChunkguia_noivas||[]).push([[237],{253:(T,I,s)=>{s.d(I,{t:()=>v});var p=s(1413),f=s(6129);class A extends p.B{constructor(c=1/0,u=1/0,d=f.U){super(),this._bufferSize=c,this._windowTime=u,this._timestampProvider=d,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=u===1/0,this._bufferSize=Math.max(1,c),this._windowTime=Math.max(1,u)}next(c){const{isStopped:u,_buffer:d,_infiniteTimeWindow:l,_timestampProvider:e,_windowTime:o}=this;u||(d.push(c),!l&&d.push(e.now()+o)),this._trimBuffer(),super.next(c)}_subscribe(c){this._throwIfClosed(),this._trimBuffer();const u=this._innerSubscribe(c),{_infiniteTimeWindow:d,_buffer:l}=this,e=l.slice();for(let o=0;o<e.length&&!c.closed;o+=d?1:2)c.next(e[o]);return this._checkFinalizedStatuses(c),u}_trimBuffer(){const{_bufferSize:c,_timestampProvider:u,_buffer:d,_infiniteTimeWindow:l}=this,e=(l?1:2)*c;if(c<1/0&&e<d.length&&d.splice(0,d.length-e),!l){const o=u.now();let n=0;for(let a=1;a<d.length&&d[a]<=o;a+=2)n=a;n&&d.splice(0,n+1)}}}var m=s(8750),C=s(7707),g=s(9974);function D(h,c,...u){if(!0===c)return void h();if(!1===c)return;const d=new C.Ms({next:()=>{d.unsubscribe(),h()}});return(0,m.Tg)(c(...u)).subscribe(d)}function v(h,c,u){let d,l=!1;return h&&"object"==typeof h?({bufferSize:d=1/0,windowTime:c=1/0,refCount:l=!1,scheduler:u}=h):d=h??1/0,function O(h={}){const{connector:c=()=>new p.B,resetOnError:u=!0,resetOnComplete:d=!0,resetOnRefCountZero:l=!0}=h;return e=>{let o,n,a,i=0,r=!1,t=!1;const E=()=>{n?.unsubscribe(),n=void 0},U=()=>{E(),o=a=void 0,r=t=!1},R=()=>{const y=o;U(),y?.unsubscribe()};return(0,g.N)((y,_)=>{i++,!t&&!r&&E();const P=a=a??c();_.add(()=>{i--,0===i&&!t&&!r&&(n=D(R,l))}),P.subscribe(_),!o&&i>0&&(o=new C.Ms({next:F=>P.next(F),error:F=>{t=!0,E(),n=D(U,u,F),P.error(F)},complete:()=>{r=!0,E(),n=D(U,d),P.complete()}}),(0,m.Tg)(y).subscribe(o))})(e)}}({connector:()=>new A(d,c,u),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:l})}},589:(T,I,s)=>{s.d(I,{R:()=>v});var p=s(5312),f=s(7673),A=s(253),m=s(6354),C=s(9437),g=s(863),O=s(3214),D=s(8989);let v=(()=>{class h{http;cache$;fallback=[{id:"fotografia",nome:"Fotografia",slug:"fotografia",descricao:"Profissionais para registrar seu grande dia.",imageId:null,imageUrl:"assets/categorias/fotografia.jpg"},{id:"buffet",nome:"Buffet",slug:"buffet",descricao:"Buffets e servi\xe7os de alimenta\xe7\xe3o para eventos.",imageId:null,imageUrl:"assets/categorias/buffet.jpg"},{id:"decoracao",nome:"Decora\xe7\xe3o",slug:"decoracao",descricao:"Decora\xe7\xe3o e ambienta\xe7\xe3o para casamentos.",imageId:null,imageUrl:"assets/categorias/decoracao.jpg"},{id:"musica",nome:"M\xfasica",slug:"musica",descricao:"Bandas, DJs e m\xfasicos para cerim\xf4nia e festa.",imageId:null,imageUrl:"assets/categorias/musica.jpg"},{id:"espacos",nome:"Espa\xe7os",slug:"espacos",descricao:"Locais para realiza\xe7\xe3o de eventos.",imageId:null,imageUrl:"assets/categorias/espacos.jpg"},{id:"vestidos",nome:"Vestido de Noiva",slug:"vestidos",descricao:"Estilistas e lojas especializadas.",imageId:null,imageUrl:"assets/categorias/vestidos.jpg"}];getAll(){return this.cache$||(this.cache$=this.http.get(`${p.c.API_BASE_URL}/public/categorias/vitrine`).pipe((0,m.T)(u=>((Array.isArray(u)?u:u?.data||[])||[]).map(l=>{const e=l.id||l.Id,o=l.nome||l.Nome||"",a=String(l.slug||l.Slug||e||o).normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"").replace(/[^\w\s-]/g,"").trim().replace(/\s+/g,"-").toLowerCase(),i=l.descricao??l.Descricao??null,r=l.imageId||l.ImageId||null,t=l.imageUrl||l.ImageUrl||null,E=l.thumbnailUrl||l.ThumbnailUrl||null,U=l.icon||l.Icon||null,R=l.totalSuppliers??l.TotalSuppliers??null,y=(l.vitrineSuppliers||l.VitrineSuppliers||[]).map(_=>({id:_.id||_.Id,nome:_.nome||_.Nome||"",slug:_.slug||_.Slug||"",cidade:_.cidade||_.Cidade||null,rating:_.rating??_.Rating??null,primaryImageUrl:_.primaryImageUrl||_.PrimaryImageUrl?(0,g.Z)(_.primaryImageUrl||_.PrimaryImageUrl):null}));return{id:e,nome:o,slug:a,descricao:i,imageId:r,imageUrl:E?(0,g.Z)(E):t?(0,g.Z)(t):null,icon:U,thumbnailUrl:E?(0,g.Z)(E):null,totalSuppliers:R,vitrineSuppliers:y}})),(0,C.W)(()=>(0,f.of)(this.fallback)),(0,A.t)(1))),this.cache$}clearCache(){this.cache$=void 0}getBySlug(u){const d=String(u).normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"").replace(/[^\w\s-]/g,"").trim().replace(/\s+/g,"-").toLowerCase();return this.getAll().pipe((0,m.T)(l=>l.find(e=>e.slug===d||e.id===u)))}constructor(u){this.http=u}static \u0275fac=function(d){return new(d||h)(O.KVO(D.Qq))};static \u0275prov=O.jDH({token:h,factory:h.\u0275fac,providedIn:"root"})}return h})()},863:(T,I,s)=>{s.d(I,{Z:()=>f,d:()=>A});var p=s(5312);function f(m,C="assets/fornecedores/placeholder.jpg"){if(!m)return C;if(m.startsWith("http://")||m.startsWith("https://")||m.startsWith("assets/")||m.startsWith("/assets/"))return m;const O=(p.c.API_BASE_URL?.replace(/\/$/,"")||"").replace(/\/api\/v1$/,"");let D=m.startsWith("/")?m:`/${m}`;return D.startsWith("/api/v1/")&&(D=D.replace("/api/v1","")),`${O}${D}`}function A(m,C){if(!m.startsWith("http"))return m;const g=m.includes("?")?"&":"?";return`${m}${g}cb=${encodeURIComponent(C)}`}},6129:(T,I,s)=>{s.d(I,{U:()=>p});const p={now:()=>(p.delegate||Date).now(),delegate:void 0}},6730:(T,I,s)=>{s.d(I,{e:()=>p});var p=function(f){return f[f.Zombie=-2]="Zombie",f[f.Low=-1]="Low",f[f.Free=0]="Free",f[f.Vitrine=1]="Vitrine",f}(p||{})},7237:(T,I,s)=>{s.d(I,{m:()=>u});var p=s(6354),f=s(9437),A=s(7673),m=s(5558),C=s(253),g=s(5312),O=s(6730),D=s(863),v=s(3214),h=s(7981),c=s(589);let u=(()=>{class d{api;categoriasData;highlightsCache=new Map;search(e,o=1,n=12,a){const i=(e||"").trim(),r={page:o,pageSize:n};return i.length&&(r.q=i,r.nome=i,r.descricao=i),void 0!==a&&(r.destaque=a),null!==g.c.FORNECEDOR_PUBLICADO&&(r.publicado=g.c.FORNECEDOR_PUBLICADO),this.api.get("/search/fornecedores",r).pipe((0,p.T)(t=>(Array.isArray(t)?t:t.data||t.Data||[]).map(U=>this._mapToFornecedorListDto(U))))}_mapToFornecedorListDto(e){if(!e)return{};let o;const n=e.categoria||e.Categoria;"string"==typeof n?o={id:"",nome:n,slug:""}:n&&"object"==typeof n&&(o={id:n.id||n.Id||"",nome:n.nome||n.Nome||"",slug:n.slug||n.Slug||""});const a=e.primaryImage||e.PrimaryImage||{},i=e.fotoUrl||e.FotoUrl||e.imageUrl||e.ImageUrl||a.url||a.Url;let r=e.planLevel??e.PlanLevel;return void 0===r&&(r=e.destaque??e.Destaque?O.e.Vitrine:O.e.Free),{id:e.id||e.Id,nome:e.nomeFantasia||e.NomeFantasia||e.nome||e.Nome,slug:e.slug||e.Slug,descricao:e.descricao||e.Descricao,cidade:e.cidade||e.Cidade,rating:e.rating??e.Rating??null,destaque:e.destaque??e.Destaque??!1,seloFornecedor:e.seloFornecedor??e.SeloFornecedor??!1,ativo:e.ativo??e.Ativo??!0,instagram:e.instagram||e.Instagram||e.socialMedia?.instagram||e.SocialMedia?.Instagram,categoria:o,planLevel:r,primaryImage:i?{id:a.id||a.Id||"primary",url:(0,D.Z)(i),filename:a.filename||a.Filename||"",contentType:a.contentType||a.ContentType||"",isPrimary:!0}:void 0,imagens:(e.imagens||e.Imagens||e.gallery||e.Gallery||[]).map(t=>({id:t.id||t.Id,url:(0,D.Z)(t.url||t.Url),isPrimary:t.isPrimary??t.IsPrimary??!1,orderIndex:t.orderIndex??t.OrderIndex??0}))}}constructor(e,o){this.api=e,this.categoriasData=o}getAll(e=1,o=12){const n={page:e,pageSize:o};return null!==g.c.FORNECEDOR_PUBLICADO&&(n.publicado=g.c.FORNECEDOR_PUBLICADO),this.api.get("/fornecedores/ativos",n).pipe((0,p.T)(a=>(a.data||[]).map(i=>this._mapToFornecedorListDto(i))))}getDestaques(e=1,o=24){const n={page:e,pageSize:o,destaque:!0};return null!==g.c.FORNECEDOR_PUBLICADO&&(n.publicado=g.c.FORNECEDOR_PUBLICADO),this.api.get("/fornecedores/ativos",n).pipe((0,p.T)(a=>{let i=[];return Array.isArray(a)?i=a:a&&Array.isArray(a.data)?i=a.data:console.warn("[DESTAQUES] formato inesperado da resposta:",a),i.map(r=>this._mapToFornecedorListDto(r))}),(0,p.T)(a=>{const i=a.filter(r=>r.destaque);return a.length>0&&0===i.length&&console.warn("[DESTAQUES] nenhum fornecedor com destaque=true encontrado na lista"),i.length>0?i:a}),(0,f.W)(a=>(console.error("[DESTAQUES] API error:",a),(0,A.of)([]))))}getById(e,o=!1){const a=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/.test(e)?`/public/fornecedores/${e}`:`/public/fornecedores/slug/${e.toLowerCase()}`,i={};return o&&(i.preview="true"),this.api.get(a,i).pipe((0,p.T)(r=>this._mapDetailToFornecedor(r)),(0,f.W)(r=>{throw r}))}_mapDetailToFornecedor(e){if(!e)return{};let o=e.imagens||e.Imagens||e.gallery||e.Gallery||[];!Array.isArray(o)&&"object"==typeof o&&(o=[o]);const n=o.filter(t=>t&&(t.url||t.Url)).map(t=>({id:t.id||t.Id,url:(0,D.Z)(t.url||t.Url),filename:t.filename||t.Filename,contentType:t.contentType||t.ContentType,isPrimary:t.isPrimary??t.IsPrimary??!1,orderIndex:t.orderIndex??t.OrderIndex??0})),a=e.fotoUrl||e.FotoUrl;a&&!n.some(t=>t.url===a)&&n.unshift({id:"primary",url:(0,D.Z)(a),isPrimary:!0,orderIndex:-1});const i=e.categoria||e.Categoria,r="object"==typeof i&&null!==i?i.nome||i.Nome:i;return{id:e.id||e.Id,nome:e.nomeFantasia||e.NomeFantasia||e.nome||e.Nome,slug:e.slug||e.Slug,descricao:e.descricao||e.Descricao,publicado:e.publicado??e.Publicado??!0,cidade:e.cidade||e.Cidade,endereco:e.endereco||e.Endereco,horarioFuncionamento:e.horarioFuncionamento||e.HorarioFuncionamento,telefone:e.phoneDisplay||e.PhoneDisplay||e.telefone||e.Telefone,email:e.email||e.Email,website:e.website||e.Website,instagram:e.instagram||e.Instagram||e.socialMedia?.instagram||e.SocialMedia?.Instagram,facebook:e.facebook||e.Facebook||e.socialMedia?.facebook||e.SocialMedia?.Facebook,destaque:e.destaque??e.Destaque??!1,seloFornecedor:e.seloFornecedor??e.SeloFornecedor??!1,ativo:e.ativo??e.Ativo??!0,rating:e.rating??e.Rating??null,visitas:e.visitas??e.Visitas??0,categoria:r||null,imagens:n.sort((t,E)=>t.orderIndex-E.orderIndex),depoimentos:(e.testemunhos||e.Testemunhos||e.testimonials||e.Testimonials||[]).map(t=>({texto:t.descricao||t.Descricao||t.texto||t.Texto,casal:t.nome||t.Nome||t.casal||t.Casal})),planLevel:e.planLevel??e.PlanLevel??O.e.Zombie,isClaimed:e.isClaimed??e.IsClaimed??!1,totalLeadsAllTime:e.totalLeadsAllTime??e.TotalLeadsAllTime??0,leadLimit:e.leadLimit??e.LeadLimit??3,whatsAppUrl:e.whatsAppUrl||e.WhatsAppUrl,showContactForm:e.showContactForm??e.ShowContactForm??!0,adInjection:(e.adInjection||e.AdInjection||[]).map(t=>({id:t.id||t.Id,nome:t.nomeFantasia||t.NomeFantasia||t.nome||t.Nome,slug:t.slug||t.Slug,categoria:t.categoria||t.Categoria,imagemPrincipal:(0,D.Z)(t.imagemPrincipal||t.ImagemPrincipal||t.fotoUrl||t.FotoUrl),descricao:t.descricao||t.Descricao,cidade:t.cidade||t.Cidade}))}}getByCategoria(e){const o={page:1,pageSize:12};return null!==g.c.FORNECEDOR_PUBLICADO&&(o.publicado=g.c.FORNECEDOR_PUBLICADO),/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/.test(e)?this.api.get(`/fornecedores/ativos/categoria/${e}`,o).pipe((0,p.T)(a=>(Array.isArray(a)?a:a.data||a.Data||[]).map(r=>this._mapToFornecedorListDto(r)))):this.categoriasData.getBySlug(e).pipe((0,m.n)(a=>a?this.api.get(`/fornecedores/ativos/categoria/${a.id}`,o).pipe((0,p.T)(i=>(Array.isArray(i)?i:i.data||i.Data||[]).map(t=>this._mapToFornecedorListDto(t)))):(0,A.of)([])))}getDestaquesByCategoria(e){const o={page:1,pageSize:24,destaque:!0};null!==g.c.FORNECEDOR_PUBLICADO&&(o.publicado=g.c.FORNECEDOR_PUBLICADO);const n=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/.test(e),a=i=>this.api.get(`/fornecedores/ativos/categoria/${i}`,o).pipe((0,p.T)(r=>(Array.isArray(r)?r:r.data||r.Data||[]).map(E=>this._mapToFornecedorListDto(E))),(0,f.W)(()=>this.getByCategoria(i).pipe((0,p.T)(r=>r.filter(t=>t.destaque)))));return n?a(e):this.categoriasData.getBySlug(e).pipe((0,m.n)(i=>i?a(i.id):(0,A.of)([])))}getDestaquesByCategoriaId(e){const o=`destaques-cat-id-${e}`;if(this.highlightsCache.has(o))return this.highlightsCache.get(o);const n={page:1,pageSize:24,destaque:!0};null!==g.c.FORNECEDOR_PUBLICADO&&(n.publicado=g.c.FORNECEDOR_PUBLICADO);const a=this.api.get(`/fornecedores/ativos/categoria/${e}`,n).pipe((0,p.T)(i=>(Array.isArray(i)?i:i.data||i.Data||[]).map(t=>this._mapToFornecedorListDto(t)).filter(t=>t.destaque)),(0,f.W)(i=>(console.warn("[DESTAQUES BY CATEGORIA ID] error:",i),(0,A.of)([]))),(0,C.t)(1));return this.highlightsCache.set(o,a),a}termoCache$;getTermoAdesao(){return this.termoCache$||(this.termoCache$=this.api.get("/contratos/termo-adesao").pipe((0,C.t)(1))),this.termoCache$}clearTermoCache(){this.termoCache$=void 0}claimProfile(e,o){return this.api.post(`/fornecedores/${e}/claim`,o)}static \u0275fac=function(o){return new(o||d)(v.KVO(h.G),v.KVO(c.R))};static \u0275prov=v.jDH({token:d,factory:d.\u0275fac,providedIn:"root"})}return d})()}}]);